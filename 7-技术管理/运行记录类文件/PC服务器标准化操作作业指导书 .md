

---

### **PC服务器标准化操作作业指导书 (SOP)**



#### **1. 目的**
规范服务器上下电、硬件维护、系统安装、配置变更等关键操作流程，明确操作步骤与风险点，保障服务器稳定运行与业务连续性。

#### **2. 适用范围**
适用于本公司所有物理PC服务器的日常操作与维护工作。

#### **3. 职责与权限**
*   **运维工程师:** 负责按照本SOP执行具体操作。
*   **运维负责人:** 负责对高风险操作进行审批和授权。
*   **变更管理委员会 (CAB):** 负责对影响业务的重大变更进行评审。

#### **4. 操作原则**
*   **授权原则:** 任何操作必须获得相应授权（工单/邮件/口头），严禁未经授权操作。
*   **备份原则:** 执行可能丢失数据的操作前，必须确认已有有效备份。
*   **告知原则:** 操作前需通知相关业务方，操作后需确认业务恢复正常。
*   **记录原则:** 所有操作必须及时、准确地记录在案。

#### **5. 通用操作流程 (适用于所有操作)**
1.  **【申请审批】** 提交操作申请，明确操作内容、时间窗口、影响范围、回滚方案，并获得审批。
2.  **【制定方案】** 编写详细操作步骤，包括命令、脚本、检查点等。
3.  **【通知】** 提前通知所有相关方（开发、测试、业务部门等）。
4.  **【备份】** 检查或执行相关数据和配置的备份。
5.  **【操作】** 在指定时间窗口内，严格按照方案执行操作。
6.  **【验证】** 操作完成后，立即进行功能与性能验证。
7.  **【观察】** 操作后保持一段时间的观察期，确认系统稳定。
8.  **【记录与归档】** 更新运维文档，记录操作详情和结果。

---

### **核心作业指导**

#### **作业一：服务器正常上电/下电操作**

**1. 正常下电 (计划内维护)**
| 步骤 | 操作说明                                                     | 风险提示         | 记录项         |
| :--- | :----------------------------------------------------------- | :--------------- | :------------- |
| 1    | **申请** 获得下电操作审批。                                  | 业务中断         | 审批工单号     |
| 2    | **通知** 告知用户业务中断时间。                              | 沟通不到位       | 通知记录       |
| 3    | **应用层停机** 按顺序停止上层应用服务。                      | 数据丢失         | 停止的服务列表 |
| 4    | **系统层关机** (Linux): 执行 `shutdown -h now` 或 `init 0`。 (Windows): 通过开始菜单正常关机。 | **严禁硬关机!**  | 关机命令截图   |
| 5    | **等待关机** 等待系统完全关闭（可通过管理口确认操作系统状态为off）。 | 未完全关闭就断电 | 管理口状态截图 |
| 6    | **断电** 断开PDU电源开关或服务器电源线。                     | 电弧             | 操作人/时间    |

**2. 正常上电**
| 步骤 | 操作说明                                               | 风险提示     | 记录项         |
| :--- | :----------------------------------------------------- | :----------- | :------------- |
| 1    | **检查** 确认电源线路连接正常，环境无异常。            | 短路风险     | 检查结果       |
| 2    | **上电** 打开PDU开关，按下服务器电源按钮。             |              | 操作人/时间    |
| 3    | **监控启动** 通过管理口或显示器监控启动过程。          | 启动失败     | 启动画面截图   |
| 4    | **系统检查** 登录系统，检查文件系统是否正常(`df -h`)。 | 文件系统损坏 | 检查结果       |
| 5    | **服务检查** 按顺序启动应用服务，检查服务状态。        | 服务启动失败 | 启动的服务列表 |
| 6    | **业务验证** 通知业务方进行业务验证。                  | 业务功能异常 | 验证结果       |

#### **作业二：操作系统安装 (以CentOS为例)**

| 步骤 | 操作说明                                                     | 关键检查点/命令                              | 记录项       |
| :--- | :----------------------------------------------------------- | :------------------------------------------- | :----------- |
| 1    | **规划** 确定IP、主机名、分区方案、RAID级别、安装源。        |                                              | 安装规划表   |
| 2    | **配置RAID** 服务器启动时进入RA卡管理界面配置RAID。          | RAID状态为Optimal                            | RAID配置截图 |
| 3    | **引导安装** 通过iDRAC虚拟光驱挂载ISO镜像或U盘引导。         |                                              | 引导方式     |
| 4    | **系统安装** 选择最小化安装，按规划配置分区、网络、主机名。  | 分区大小、SWAP大小                           | 分区方案截图 |
| 5    | **安装后配置** 1. 配置Yum源。 2. 安装必要工具(`vim, wget, net-tools`)。 3. 关闭SELinux和Firewalld(或配置策略)。 4. 配置NTP时间同步。 | `ping baidu.com` `ntpdate -u ntp.aliyun.com` | 配置清单     |
| 6    | **系统更新** `yum update -y` (更新后建议重启)。              |                                              | 更新包列表   |
| 7    | **制作镜像** 对标准化系统制作模板镜像，以备后续使用。        |                                              | 镜像存放位置 |

#### **作业三：配置变更 (如网络、防火墙)**

| 步骤 | 操作说明                                                     | 风险提示                       | 回滚方案                             | 记录项       |
| :--- | :----------------------------------------------------------- | :----------------------------- | :----------------------------------- | :----------- |
| 1    | **备份** 备份要修改的配置文件。`cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak.$(date +%F)` | 配置错误导致服务中断或无法连接 | 使用备份文件覆盖                     | 备份文件路径 |
| 2    | **测试** 在测试环境验证配置变更的有效性。                    |                                |                                      | 测试结果     |
| 3    | **变更** 使用自动化工具(Ansible)或**手动逐台**修改。**避免批量操作!** | 批量误操作                     | 执行 `ansible-playbook rollback.yml` | 执行的命令   |
| 4    | **重载服务** 使用重载命令而非重启命令（如果支持）。`systemctl reload sshd` | 重启服务可能导致会话中断       |                                      | 重载命令     |
| 5    | **预验证** 在操作服务器上初步验证变更是否生效。`ss -tunlp | grep :22` |                                |                                      | 验证命令输出 |
| 6    | **观察** 观察一段时间（如10分钟），确认服务稳定。            | 潜在问题未发现                 |                                      | 观察日志     |
| 7    | **全面验证** 从客户端或其他机器进行验证。                    |                                |                                      | 最终验证结果 |

---

#### **6. 紧急操作与回滚**
*   **紧急情况定义:** 如服务器宕机、业务中断、遭受攻击等。
*   **紧急操作流程:** 可**先操作后补单**，但必须：
    1.  立即口头通知直属领导和相关方。
    2.  操作过程尽量有两人在场或通过屏幕共享记录。
    3.  操作后24小时内补全所有审批和记录手续。
*   **回滚方案:** 任何变更操作前，必须在方案中明确**回滚触发条件**、**回滚步骤**和**回滚时限**。

#### **7. 记录与文档管理**
所有操作记录必须填写至 **《服务器运维操作记录单》** 并归档，记录单应包含但不限于：
*   操作时间、操作人、审批人
*   服务器信息（IP/主机名）
*   操作目的和详细步骤
*   操作前后状态截图或命令输出
*   验证结果和结论

---
**修订记录:**
| 版本 | 修订日期 | 修订内容         | 修订人 |
| :--- | :------- | :--------------- | :----- |
| V1.0 |          | 初版发布         | 郑永伟 |
| V1.2 |          | 增加紧急操作流程 | 郑永伟 |